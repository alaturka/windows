name: Windows
on: [push, pull_request]

jobs:
  main:
    runs-on: windows-latest
    steps:
      - name: ğŸ›ï¸ Checkout
        uses: actions/checkout@v2.4.0

      # Cache restoring issues: https://github.com/actions/cache/issues/198
      - name: ğŸ“ Cache
        id: cacher
        uses: actions/cache@v2
        with:
          path: 'C:\Program Files\WindowsPowerShell\Modules'
          key: ${{ runner.os }}-PSScriptAnalyzer

      - name: ğŸ”§ Setup
        if: steps.cacher.outputs.cache-hit != 'true'
        shell: powershell
        run: |
          .local/bin/setup.ps1

      - name: ğŸ” Check
        shell: powershell
        run: |
          .local/bin/check.ps1

      - name: ğŸ”¬ Test
        shell: powershell
        run: |
          .local/bin/test.ps1
